<html>
  <script>
    class Lancamento {
      constructor(categoria, tipo, valor) {
        if (tipo !== "receita" && tipo !== "despesa") throw new Error('Tipo inválido [receita / despesa]')
        if (valor <= 0) throw new Error('Valor precisa ser um número positivo')
        if (!categoria) throw new Error('Categoria deve ser informada')
        this.categoria = categoria
        this.tipo = tipo
        this.valor = valor
      }
    }

    function arredondar (valor) {
      return Math.round(valor * 100) / 100
    }

    function calcularJuros(valor) {
      return arredondar(valor * 0.1)
    }

    function calcularRendimentos(valor) {
      return arredondar(valor * 0.005)
    }

    function distribuirDespesas (lancamentos, totalDespesas) {
      distribuicaoDeDespesas = []
      for (lancamento of lancamentos) {
        if (lancamento.tipo !== 'despesa') continue
        percentual = arredondar((lancamento.valor / totalDespesas) * 100)
        distribuicaoDeDespesas.push({ categoria: lancamento.categoria, percentual })
      }
      return distribuicaoDeDespesas
    }

    function calcularSaldo(saldoInicial, lancamentos) {
      totalizadorDoMes = { saldoInicial, saldo: 0, juros: 0, rendimentos: 0, receitas: 0, despesas: 0, distribuicaoDeDespesas: [] }
      totalizadorDoMes.saldo = saldoInicial
      for (lancamento of lancamentos) {
        if (lancamento.tipo === "receita") {
          totalizadorDoMes.saldo += lancamento.valor
          totalizadorDoMes.receitas += lancamento.valor
        }
        if (lancamento.tipo === "despesa") {
          totalizadorDoMes.saldo -= lancamento.valor
          totalizadorDoMes.despesas += lancamento.valor
        }
      }
      totalizadorDoMes.distribuicaoDeDespesas = distribuirDespesas(lancamentos, totalizadorDoMes.despesas)
      if (totalizadorDoMes.saldo < 0) {
        totalizadorDoMes.juros = calcularJuros(totalizadorDoMes.saldo)
        totalizadorDoMes.saldo = arredondar(totalizadorDoMes.saldo += totalizadorDoMes.juros)
      } else {
        totalizadorDoMes.rendimentos = calcularRendimentos(totalizadorDoMes.saldo)
        totalizadorDoMes.saldo = arredondar(totalizadorDoMes.saldo += totalizadorDoMes.rendimentos)
      }
      return totalizadorDoMes
    }

    // Janeiro
    saldoInicial = 0
    lancamentos = [
      new Lancamento("Salário", "receita", 3000 ),
      new Lancamento("Aluguel", "despesa", 1000 ),
      new Lancamento("Conta de Luz", "despesa", 200 ),
      new Lancamento("Conta de Água", "despesa", 150 ),
      new Lancamento("Internet", "despesa", 100 ),
      new Lancamento("Transporte", "despesa", 340 ),
      new Lancamento("Lazer", "despesa", 300 ),
      new Lancamento("Alimentação", "despesa", 500 ),
      new Lancamento("Condomínio", "despesa", 300 ),
      new Lancamento("Farmácia", "despesa", 10)
    ]
    totalizadorJaneiro = calcularSaldo(saldoInicial, lancamentos)
    console.log("Janeiro:", totalizadorJaneiro)

    // Fevereiro
    lancamentos = [
      new Lancamento("Salário", "receita", 3000),
      new Lancamento("Aluguel", "despesa", 1200),
      new Lancamento("Conta de Luz", "despesa", 100),
      new Lancamento("Conta de Água", "despesa", 250),
      new Lancamento("Internet", "despesa", 100),
      new Lancamento("Transporte", "despesa", 300),
      new Lancamento("Lazer", "despesa", 300),
      new Lancamento("Alimentação", "despesa", 1000),
      new Lancamento("Condomínio", "despesa", 300),
    ]
    totalizadorFevereiro = calcularSaldo(totalizadorJaneiro.saldo, lancamentos)
    console.log("Fevereiro:", totalizadorFevereiro)

    // Março
    lancamentos = [
      new Lancamento("Salário", "receita", 4000),
      new Lancamento("Aluguel", "despesa", 1200),
      new Lancamento("Conta de Luz", "despesa", 100),
      new Lancamento("Conta de Água", "despesa", 250),
      new Lancamento("Internet", "despesa", 100),
      new Lancamento("Transporte", "despesa", 300),
      new Lancamento("Lazer", "despesa", 300),
      new Lancamento("Alimentação", "despesa", 500),
      new Lancamento("Condomínio", "despesa", 1250),
      new Lancamento("Farmácia", "despesa", 400),
    ]
    totalizadorMarco = calcularSaldo(totalizadorFevereiro.saldo, lancamentos)
    console.log("Março:", totalizadorMarco)
  </script>
</html>